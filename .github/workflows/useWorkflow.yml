name: Check if version change

on:
  pull_request:
    branches: ["main", "develop"]

jobs:
  check_if_version_changed:
    uses: ./.github/workflows/test-change-version.yml
    with:
      current_branch: ${{ github.ref }}
      target_branch: ${{ github.event.pull_request.base.ref }}
 
  deploy1:   
    runs-on: ubuntu-latest
    needs:
      - check_if_version_changed
    steps:
      - run: echo "Version has changed ? ${{ needs.check_if_version_changed.outputs.if_version_changed }}"
      - run: echo "Version is ${{ needs.check_if_version_changed.outputs.to_version }}"

  deploy-on-if:   
    runs-on: ubuntu-latest
    needs:
      - check_if_version_changed
    if: ${{ needs.check_if_version_changed.outputs.if_version_changed == 'true' }} 
    steps:
      - run: echo "Version has changed !"
